# LCD显示中文或特殊符号

## 简介

这个文档主要记录如何在SPI_ST7735_1.8寸TFTLCD屏上显示中文或特殊符号。

## 操作步骤

### 一、提取字模

在这一步中，我们将需要显示在LCD屏幕中的中文字符/其他特殊符号对应的二进制字模提取出来。

具体流程可以参考老师提供教程中的`LCD汉字取模教程.docx`这一文件，拿到`PCtoLCD2002.exe`这一软件输出的十六进制串后即可，这一串如下所示：

```plain
0x00, 0x00, 0x80, ...
```

注意：目前代码中只使用了16×8的字模，因此在提取字模时需要将字模大小设置为16×8。

### 二、将对应字模输入`mi`文件中

在这一步中，我们将生成的二进制串输入`mi`文件。

`mi`文件即`/src/AsciiROM_8x2660.mi`，这一文件的格式如下：

```plain
// 指定文件为十六进制
#File_format=Hex
// 指定地址深度，加一行就加一
#Address_depth=2724
// 指定数据宽度
#Data_width=8
// 具体的数据
00
...
```

因此，我们需要将生成的字模二进制串一个个输入文件中，并修改文件顶部的`Address_depth`。

例如：我们需要新增一个`℃`符号，那么我们需要将`mi`文件中的`Address_depth`修改为`原始值 + 16`，并在文件末尾新增`℃`这一符号对应的十六行二进制码。

### 三、根据更新后的`mi`文件定制pROM核

在这一步中，我们需要根据更新后的`mi`文件定制pROM核。

在高云IDE中选择上方选项栏的`IP Core Generator`选项，并点击文件夹图标打开原先的`.ipc`文件，修改`Address Depth`为`mi`文件中的`Address_depth`，并点击确定，在弹窗确认是否将更新的文件加入项目是选择`Yes`。

至此，我们已经可以使用二进制码调用新增的字模。

### 四、调用新增的字模

在这一步中，我们在屏幕上显示新增的字模。

找到`/src/lcd_show_char.v`这一文件，在渲染字符的位置，使用`ascii_num <= 'd95`会渲染出的就是新增的第一个字模。

以下解释为什么是`'d95`：

已有的`mi`文件中一共有96×2个字符，前96个字符对应12×6字模，后96个字符对应16×8字模。使用哪种大小的字模是由`en_size`这一变量控制的，在本程序中默认使用16×8大小的字模。使用这一大小字模中的哪个字模是由`ascii_num`控制的，因此`'d95`即为新增的第一个字模。

以此类推，新增的第二个字符可以通过`ascii_num <= 'd96`来调用。
